---
title: "Untitled"
author: "Valentine BERTHIER"
date: "2024-01-14"
output: html_document
bibliography : projet-stat-2A.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
rm(list=ls())
library(dplyr)
library(ggplot2)

donnees_AMR <- read_excel("donnees/donnees_AMR.xlsx")
str(donnees_AMR)
summary(donnees_AMR)

# Je crée 2 datasets pour analyser les populations distinctement entre animale et humaine
donnees_AMR_animale <- donnees_AMR %>%
  filter(famille == "animale")
donnees_AMR_humaine <- donnees_AMR %>%
  filter(famille == "humaine")
```

VARIATIONS INTER-GROUPES
```{r}
# Pour les animaux, on regarde la moyenne de l'AMR pour chaque population
moyenne_AMR <- donnees_AMR_animale %>%
  group_by(population, famille) %>%
  summarize(moyenne_AMR = mean(`valeur AMR`))

# On regarde la variance inter-groupe (et l'écart-type car plus parlant)
donnees_AMR %>% summarize(ecart_type_AMR = sd(`valeur AMR`))
donnees_AMR %>%
  group_by(population, famille) %>%
  summarize(
    moyenne_AMR = mean(`valeur AMR`),
    .groups = 'drop'
  ) %>%
  ungroup() %>%
  summarize(
    SSB = sum((moyenne_AMR - mean(moyenne_AMR))^2 * n())
  )

# Plot des moyennes (agrandir le graphique pour la lisibilité)
ggplot(moyenne_AMR, aes(x = reorder(population, moyenne_AMR), y = moyenne_AMR, fill = famille)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Moyenne de l'AMR par population",
       x = "Population",
       y = "Moyenne de l'AMR") +
  theme_minimal()
```
Variation inter-groupes plutôt importante chez les animaux : de 13,02 pour la population veau, à 62,39 pour la population chat et écart-type de 16,97. Variance inter-groupe de 77353,6.

Pour poursuivre l'analyse :
Similarité entre les populations possédant des moyennes proches (chat et chien qui vivent avec l'Homme --> moyenne parmis les plus élevées) ?
La région influe-t-elle sur la moyenne et la variabilité ?
Les populations en abattoir possèdent-elles des moyennes sensiblement différentes des autres populations (ex : porc abattoir vs porc "classique") ?


VARIATIONS INTRA-GROUPES
```{r}
donnees_AMR_animale %>%
  group_by(population, famille) %>%
  summarize(
    variance_intragroupe = sum((`valeur AMR` - mean(`valeur AMR`))^2),
    .groups = 'drop'
  )
```
Variance intra-groupe volatile en fonction des années --> d'où vient cette variabilité ? est-ce une tendance (croissante/décroissante) ou un phénomène aléatoire ?
Similarités entre les population possédant des variances 

Pour poursuivre l'analyse :
Graphe des moyennes selon les années.
